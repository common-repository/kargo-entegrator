import{d as X,r as C,o as n,b as c,a as e,u as s,c as q,e as M,f,t as i,n as R,g as A,h as V,F as U,i as Z,w as _,j as l,k as Y,s as L,l as O,m as z,p as ee,q as te}from"../vendor-1-0-35.js";import{u as W,s as G,d as oe,_ as se}from"../Loading-1-0-35.js";import{_ as H}from"../MdrModal-1-0-35.js";import{u as ae,_ as le,a as T,b as I,s as ne,c as re}from"../fields-1-0-35.js";import{_ as N,u as B,a as ie}from"../ResourceStore-1-0-35.js";import{_ as de}from"../ShipmentInfoModal-1-0-35.js";import{i as ce}from"../admin-app-1-0-35.js";const K=X("OrderStore",{state:()=>({shipmentStatus:window.gcargo.order_shipment_status||"ready_for_shipment"})}),ue={class:"my-2"},_e={key:1},pe={__name:"Status",setup($){const{shipmentStatus:u}=K(),p=()=>{switch(u){case"ready_for_shipment":return"text-green-600 bg-green-100";case"partial_shipped":return"text-primary-600 bg-primary-100";case"all_shipped":return"text-primary-600 bg-primary-100"}};return(o,g)=>{const v=C("check-circle-icon");return n(),c("div",ue,[e("div",{class:R(`${p()} flex !w-full py-2 px-4 gap-1 rounded-md font-semibold justify-center`)},[s(u)==="ready_for_shipment"?(n(),q(v,{key:0,class:"w-4"})):M("",!0),f(" "+i(o.$t(s(u)))+" ",1),s(u)==="ready_for_shipment"?(n(),c("span",_e,"ðŸ“¦")):M("",!0)],2)])}}},me=["id"],F={__name:"MdrAccordion",setup($){const u=Math.random().toString(20).substr(2,10);return(p,o)=>(n(),c("div",{id:s(u),class:"rounded-lg border","data-accordion":"collapse"},[A(p.$slots,"default")],8,me))}},fe=["data-accordion-target","aria-expanded"],P={__name:"MdrAccordionItem",props:{expanded:{type:Boolean,default:!1}},setup($){const u=`head-${Math.random().toString(20).substr(2,10)}`,p=`body-${Math.random().toString(20).substr(2,10)}`,g=V($.expanded),v=()=>{g.value=!g.value};return(b,m)=>(n(),c(U,null,[e("button",{id:u,type:"button",class:"flex items-center justify-between w-full p-5 rounded-lg font-medium rtl:text-right text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800 gap-3","data-accordion-target":`#${p}`,"aria-expanded":g.value,"aria-controls":p,onClick:v},[A(b.$slots,"title"),(n(),c("svg",{"data-accordion-icon":"",class:R([{"rotate-180":!g.value,"rotate-0":g.value},"w-3 h-3 shrink-0"]),"aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},m[0]||(m[0]=[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5 5 1 1 5"},null,-1)]),2))],8,fe),e("div",{id:p,class:R(`${g.value?"":"hidden"} p-5`),"aria-labelledby":u},[A(b.$slots,"default")],2)],64))}},ge={key:0},ve=["src"],ye={key:1},he={class:"flex gap-3 justify-end w-full"},$e={class:"flex gap-2"},Q={__name:"BarcodeModal",props:{modelValue:Boolean,pdfUrl:{type:String,default:""}},emits:["update:modelValue"],setup($,{emit:u}){const p=$,o=u,g=Z({get(){return p.modelValue},set(m){o("update:modelValue",m)}}),v=()=>{const m=document.querySelector("#barcode-pdf");m&&(m.contentWindow.focus(),m.contentWindow.print())},b=()=>{window.location.reload()};return(m,S)=>(n(),q(H,{modelValue:g.value,"onUpdate:modelValue":S[0]||(S[0]=y=>g.value=y),size:"md:size-4/5 lg:size-3/5"},{title:_(()=>[f(i(m.$t("barcode_prinout")),1)]),actions:_(()=>[e("div",he,[e("div",$e,[l(N,{onClick:b},{default:_(()=>[f(i(m.$t("ok")),1)]),_:1})])])]),default:_(()=>[$.pdfUrl?(n(),c("div",ge,[e("iframe",{id:"barcode-pdf",src:$.pdfUrl,width:"100%",height:"500px",onLoad:v},null,40,ve)])):(n(),c("div",ye,[e("div",null,i($.pdfUrl),1)]))]),_:1},8,["modelValue"]))}},be={key:0,class:"flex flex-col items-center justify-center gap-3 w-full pt-2"},xe={class:"flex items-start mt-4 text-xs gap-1"},ke={key:1,class:"bg-red-100 text-red-800 p-2 rounded-md"},we={href:"/wp-admin/admin.php?page=gcargo-settings",class:"underline"},Ve={key:0,class:"w-full flex bg-red-100 border-red-600 rounded-md p-4 break-all text-red-600 items-center gap-2"},Ue={class:"grid grid-cols-3 gap-4 divide-x"},Ce={class:"col-span-2 flex flex-col gap-8 overflow-auto max-h-[55vh] min-h-[55vh] pr-1"},Se={class:"font-semibold text-lg text-gray-900"},je={class:"grid grid-cols-3 gap-4"},qe={class:"font-semibold text-lg text-gray-900"},Me={class:"flex flex-col gap-4"},ze={href:"https://kargoentegrator.com"},Be={class:"flex items-center gap-4"},De={class:"border border-gray-200 rounded-lg"},Ee=["src"],Ie={class:"flex flex-col gap-2"},Re={class:"font-semibold text-xl"},Te={class:"flex items-center"},Fe={class:"flex gap-2 items-center rounded-lg bg-gray-100 px-2"},Pe=["onClick"],Ae=["textContent"],Ne=["onClick"],Ye={class:"font-semibold text-lg text-gray-900"},Le={class:"grid grid-cols-3 gap-4"},Oe={class:"flex flex-col gap-4 px-4"},We=["href"],Ge=["href"],He={key:4,class:"flex gap-2"},Ke={class:"flex gap-3 justify-end w-full"},Qe={class:"flex gap-2"},Je={__name:"Create",setup($){const{t:u}=Y(),p=window.gcargo.admin_url,{shipment:o}=L(B()),{cargoIntegrations:g,warehouses:v}=B(),{apiKey:b}=ae(),{store:m}=B(),{getPdf:S}=W(),y=V(!1),k=V({}),h=V(!1),j=V();O(()=>{o.value={...window.gcargo.shipment}});const D=async()=>{k.value={},o.value.lines=o.value.lines.filter(a=>a.quantity>0),o.value=await m({data:{resource:"shipments",data:o.value},onValidationError:a=>{k.value=a.errors,y.value=!0}}),y.value=!1,G(u("resource_added",[u("shipment")])),j.value=await S({data:{shipments:[o.value.id]}}),h.value=!0},E=(a,r)=>{let d=o.value.lines[a].quantity;d=d+r,d<0?d=0:d>o.value.lines[a].sold_qty&&(d=o.value.lines[a].sold_qty),o.value.lines[a].quantity=d};return(a,r)=>{const d=C("information-circle-icon"),x=C("exclamation-triangle-icon");return n(),c(U,null,[s(b)?(n(),c("div",be,[l(N,{class:"!w-full",onClick:r[0]||(r[0]=t=>D())},{default:_(()=>[f(i(a.$t("create_fast_shipment")),1)]),_:1}),l(ie,{class:"!w-full",onClick:r[1]||(r[1]=t=>y.value=!y.value)},{default:_(()=>[f(i(a.$t("customize_shipment")),1)]),_:1}),e("div",xe,[l(d,{class:"w-8"}),f(i(a.$t("fast_shipment_desc")),1)])])):(n(),c("div",ke,[f(i(a.$t("api_key_required"))+" ",1),e("a",we,i(a.$t("connect")),1)])),l(Q,{modelValue:h.value,"onUpdate:modelValue":r[2]||(r[2]=t=>h.value=t),"pdf-url":j.value},null,8,["modelValue","pdf-url"]),l(H,{modelValue:y.value,"onUpdate:modelValue":r[10]||(r[10]=t=>y.value=t),size:"md:size-4/5 lg:size-3/5"},{title:_(()=>[f(i(a.$t("create_shipment")),1)]),actions:_(()=>[e("div",Ke,[e("div",Qe,[l(le,{onClick:r[8]||(r[8]=t=>y.value=!y.value)},{default:_(()=>[f(i(a.$t("cancel")),1)]),_:1}),l(N,{onClick:r[9]||(r[9]=t=>D())},{default:_(()=>[f(i(a.$t("create")),1)]),_:1})])])]),default:_(()=>[k.value.api_error?(n(),c("div",Ve,[l(x,{class:"w-6 h-6"}),f(" "+i(k.value.api_error[0]),1)])):M("",!0),e("div",Ue,[e("div",Ce,[l(F,null,{default:_(()=>[l(P,{expanded:""},{title:_(()=>[e("div",Se,i(a.$t("receiver_info")),1)]),default:_(()=>[e("div",je,[(n(),c(U,null,z(["name","surname","phone","email","city","district","postcode","country","address"],t=>l(T,{key:t,modelValue:s(o).customer[t],"onUpdate:modelValue":w=>s(o).customer[t]=w,class:R(t==="address"?"col-span-3":""),label:a.$t(t),required:"",error:k.value[`customer.${t}`]},null,8,["modelValue","onUpdate:modelValue","class","label","error"])),64))])]),_:1})]),_:1}),l(F,null,{default:_(()=>[l(P,null,{title:_(()=>[e("div",qe,i(a.$t("product_info")),1)]),default:_(()=>[e("div",Me,[e("p",null,[f(i(a.$t("product_info_desc"))+" ",1),e("a",ze,i(a.$t("click_here")),1),r[11]||(r[11]=f(". "))]),(n(!0),c(U,null,z(s(o).lines,(t,w)=>(n(),c("div",{key:t.platform_id,class:"flex justify-between py-2 px-6 border rounded-lg"},[e("div",Be,[e("div",De,[e("img",{src:t.image,alt:"",srcset:"",class:"h-16 w-16 object-cover rounded-lg"},null,8,Ee)]),e("div",Ie,[e("span",Re,i(t.title),1),e("span",null," Sku : "+i(t.sku),1)])]),e("div",Te,[e("div",Fe,[e("span",{class:"font-bold px-1 text-lg cursor-pointer",onClick:J=>E(w,-1)},"-",8,Pe),e("span",{textContent:i(s(o).lines[w].quantity)},null,8,Ae),e("span",{class:"font-bold px-1 text-lg cursor-pointer",onClick:J=>E(w,1)},"+",8,Ne)])])]))),128))])]),_:1})]),_:1}),l(F,null,{default:_(()=>[l(P,null,{title:_(()=>[e("div",Ye,i(a.$t("invoice_info")),1)]),default:_(()=>[e("div",Le,[(n(),c(U,null,z(["invoice_number","waybill_number"],t=>l(T,{key:t,modelValue:s(o)[t],"onUpdate:modelValue":w=>s(o)[t]=w,label:a.$t(t),required:"",error:k.value[`${t}`]},null,8,["modelValue","onUpdate:modelValue","label","error"])),64))])]),_:1})]),_:1})]),e("div",Oe,[s(g).length>0?(n(),q(I,{key:0,modelValue:s(o).cargo_integration_id,"onUpdate:modelValue":r[3]||(r[3]=t=>s(o).cargo_integration_id=t),options:s(g),"value-key":"id","text-key":"name",label:a.$t("cargo_integration")},null,8,["modelValue","options","label"])):(n(),c("a",{key:1,href:`${s(p)}admin.php?page=gcargo-settings`,target:"_blank",class:"cursor-pointer flex gap-2 items-center underline text-sm text-red-600 hover:text-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},[l(x,{class:"w-8 h-8"}),f(i(a.$t("cargo_integration_warning")),1)],8,We)),s(v).length>0?(n(),q(I,{key:2,modelValue:s(o).warehouse_id,"onUpdate:modelValue":r[4]||(r[4]=t=>s(o).warehouse_id=t),options:s(v),"value-key":"id","text-key":"name",label:a.$t("warehouse")},null,8,["modelValue","options","label"])):(n(),c("a",{key:3,href:`${s(p)}admin.php?page=gcargo-settings`,target:"_blank",class:"cursor-pointer flex gap-2 items-center underline text-sm text-red-600 hover:text-red-700 rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},[l(x,{class:"w-8 h-8"}),f(i(a.$t("warehouse_warning")),1)],8,Ge)),(n(!0),c(U,null,z(s(ne)(s(u)),t=>(n(),q(I,{key:t.model,modelValue:s(o)[`${t.model}`],"onUpdate:modelValue":w=>s(o)[`${t.model}`]=w,label:t.label,options:t.options,"value-key":"value","text-key":"text"},null,8,["modelValue","onUpdate:modelValue","label","options"]))),128)),l(re,{modelValue:s(o).is_pay_at_door,"onUpdate:modelValue":r[5]||(r[5]=t=>s(o).is_pay_at_door=t),label:a.$t("is_pay_at_door")},null,8,["modelValue","label"]),s(o).is_pay_at_door?(n(),c("div",He,[l(T,{modelValue:s(o).total,"onUpdate:modelValue":r[6]||(r[6]=t=>s(o).total=t),type:"number",class:"w-full",label:a.$t("total"),disabled:!s(o).is_pay_at_door},null,8,["modelValue","label","disabled"]),l(I,{modelValue:s(o).currency,"onUpdate:modelValue":r[7]||(r[7]=t=>s(o).currency=t),class:"w-full",disabled:!s(o).is_pay_at_door,options:[{value:"TRY",text:"TRY"},{value:"EUR",text:"EUR"},{value:"USD",text:"USD"}],label:a.$t("currency")},null,8,["modelValue","disabled","label"])])):M("",!0)])])]),_:1},8,["modelValue"])],64)}}},Xe={class:"flex gap-4 items-center"},Ze=["src"],et={class:"flex flex-col gap-1"},tt={key:0,class:"bg-gray-100 text-gray-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded"},ot={class:"font-bold"},st={class:"grid grid-cols-5 gap-4 cursor-pointer"},at={class:"col-span-2 flex flex-col text-xs"},lt={class:"font-bold"},nt=["href"],rt={key:1,class:"text-xs"},it=["onClick"],dt=["onClick"],ct=["onClick"],ut={__name:"Info",setup($){const{t:u}=Y(),{shipments:p}=L(B()),{destroy:o}=B(),{getPdf:g}=W(),v=V([]),b=V(!1),m=V(),S=async h=>{m.value=await g({data:{shipments:[h]}}),b.value=!0};ee(()=>{p.value.forEach(h=>{v.value[h.id]=!1})});const y=async h=>{await oe(u("cancel_shipment")).on("pnotify:confirm",async()=>{await o({data:{resource:"shipments",id:h}}),G(u("resource_deleted",[u("shipment")])),window.location.reload()})},k={non_processed:"GÃ¶nderime HazÄ±r",shipped:"Yola Ã‡Ä±ktÄ±",on_transit:"TaÅŸÄ±ma SÃ¼recinde",at_delivery_center:"DaÄŸÄ±tÄ±m Merkezinde",in_courier:"DaÄŸÄ±tÄ±ma Ã‡Ä±ktÄ±",delivered:"Teslim Edildi"};return(h,j)=>{const D=C("time-format"),E=C("information-circle-icon"),a=C("printer-icon"),r=C("arrow-uturn-left-icon");return n(!0),c(U,null,z(s(p),d=>(n(),c("div",{key:d.id,class:"flex flex-col gap-4 border-b py-4"},[e("div",Xe,[e("img",{src:d.cargo_company.logo,class:"object-contan w-16"},null,8,Ze),e("div",et,[k[d.status]?(n(),c("span",tt,i(k[d.status]),1)):M("",!0),f(" "+i(d.cargo_company.title)+" ile gÃ¶nderildi ",1),e("span",ot,[l(D,{date:d.created_at},null,8,["date"])])])]),l(Q,{modelValue:b.value,"onUpdate:modelValue":j[0]||(j[0]=x=>b.value=x),"pdf-url":m.value},null,8,["modelValue","pdf-url"]),e("div",st,[e("div",at,[e("span",lt,i(h.$t("tracking_number")),1),d.tracking_number?(n(),c("a",{key:0,href:d.tracking_link,target:"_blank",class:"text-primary-600 underline text-xs"},i(d.tracking_number),9,nt)):(n(),c("span",rt,i(h.$t("not_yet_formed")),1))]),e("div",{class:"flex items-center justify-center rounded-full py-2 border text-primary-600 border-primary-600",onClick:x=>v.value[d.id]=!v.value[d.id]},[l(E,{class:"w-5"})],8,it),e("div",{class:"flex items-center justify-center rounded-full py-2 border text-primary-600 border-primary-600",onClick:x=>S(d.id)},[l(a,{class:"w-5"})],8,dt),e("button",{type:"button",class:"flex items-center justify-center rounded-full py-2 border text-red-600 border-red-600",onClick:x=>y(d.id)},[l(r,{class:"w-5"})],8,ct)]),l(de,{modelValue:v.value[d.id],"onUpdate:modelValue":x=>v.value[d.id]=x,shipment:d},null,8,["modelValue","onUpdate:modelValue","shipment"])]))),128)}}},_t={class:"relative w-full"},pt={__name:"App",setup($){const{shipmentStatus:u}=K();return O(()=>{te()}),(p,o)=>(n(),c("div",_t,[l(se),l(pe),l(ut),s(u)!=="all_shipped"?(n(),q(Je,{key:0})):M("",!0)]))}};ce(pt);
